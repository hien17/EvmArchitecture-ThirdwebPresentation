"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_thirdweb-dev_wallets_evm_connectors_wallet-connect_dist_thirdweb-dev-wallets-evm-2efe37"],{

/***/ "./node_modules/@thirdweb-dev/wallets/evm/connectors/wallet-connect/dist/thirdweb-dev-wallets-evm-connectors-wallet-connect.browser.esm.js":
/*!*************************************************************************************************************************************************!*\
  !*** ./node_modules/@thirdweb-dev/wallets/evm/connectors/wallet-connect/dist/thirdweb-dev-wallets-evm-connectors-wallet-connect.browser.esm.js ***!
  \*************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WalletConnectConnector: function() { return /* binding */ WalletConnectConnector; }\n/* harmony export */ });\n/* harmony import */ var _dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../dist/defineProperty-350fc508.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/defineProperty-350fc508.browser.esm.js\");\n/* harmony import */ var _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../dist/errors-9edc08c8.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/errors-9edc08c8.browser.esm.js\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ethers */ \"./node_modules/ethers/lib.esm/index.js\");\n/* harmony import */ var _dist_walletIds_dff6dced_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../dist/walletIds-dff6dced.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/walletIds-dff6dced.browser.esm.js\");\n/* harmony import */ var _dist_url_a45219bd_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../dist/url-a45219bd.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/url-a45219bd.browser.esm.js\");\n/* harmony import */ var _dist_WagmiConnector_2f14002d_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../dist/WagmiConnector-2f14002d.browser.esm.js */ \"./node_modules/@thirdweb-dev/wallets/dist/WagmiConnector-2f14002d.browser.esm.js\");\n/* harmony import */ var eventemitter3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! eventemitter3 */ \"./node_modules/@thirdweb-dev/wallets/node_modules/eventemitter3/index.mjs\");\n\n\n\n\n\n\n\n\n\nconst chainsToRequest = new Set([1, 137, 10, 42161, 56]);\nconst NAMESPACE = \"eip155\";\nconst REQUESTED_CHAINS_KEY = \"wagmi.requestedChains\";\nconst ADD_ETH_CHAIN_METHOD = \"wallet_addEthereumChain\";\nconst LAST_USED_CHAIN_ID = \"last-used-chain-id\";\nclass WalletConnectConnector extends _dist_WagmiConnector_2f14002d_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.W {\n  constructor(config) {\n    super({\n      ...config,\n      options: {\n        isNewChainsStale: true,\n        ...config.options\n      }\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"id\", _dist_walletIds_dff6dced_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.w.walletConnect);\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"name\", \"WalletConnect\");\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"ready\", true);\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onAccountsChanged\", accounts => {\n      if (accounts.length === 0) {\n        this.emit(\"disconnect\");\n      } else {\n        if (accounts[0]) {\n          this.emit(\"change\", {\n            account: ethers__WEBPACK_IMPORTED_MODULE_4__.utils.getAddress(accounts[0])\n          });\n        }\n      }\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onChainChanged\", async chainId => {\n      const id = Number(chainId);\n      const unsupported = this.isChainUnsupported(id);\n      await this._storage.setItem(LAST_USED_CHAIN_ID, String(chainId));\n      this.emit(\"change\", {\n        chain: {\n          id,\n          unsupported\n        }\n      });\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onDisconnect\", async () => {\n      await this._setRequestedChainsIds([]);\n      await this._storage.removeItem(LAST_USED_CHAIN_ID);\n      this.emit(\"disconnect\");\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onDisplayUri\", uri => {\n      this.emit(\"message\", {\n        type: \"display_uri\",\n        data: uri\n      });\n    });\n    (0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onConnect\", () => {\n      this.emit(\"connect\", {\n        provider: this._provider\n      });\n    });\n    this._storage = config.options.storage;\n    this._createProvider();\n    this.filteredChains = this.chains.length > 50 ? this.chains.filter(c => {\n      return chainsToRequest.has(c.chainId);\n    }) : this.chains;\n    this.showWalletConnectModal = this.options.qrcode !== false;\n  }\n  async connect() {\n    let {\n      chainId: chainIdP,\n      pairingTopic\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    try {\n      let targetChainId = chainIdP;\n      if (!targetChainId) {\n        const lastUsedChainIdStr = await this._storage.getItem(LAST_USED_CHAIN_ID);\n        const lastUsedChainId = lastUsedChainIdStr ? parseInt(lastUsedChainIdStr) : undefined;\n        if (lastUsedChainId && !this.isChainUnsupported(lastUsedChainId)) {\n          targetChainId = lastUsedChainId;\n        } else {\n          targetChainId = this.filteredChains[0]?.chainId;\n        }\n      }\n      if (!targetChainId) {\n        throw new Error(\"No chains found on connector.\");\n      }\n      const provider = await this.getProvider();\n      this.setupListeners();\n      if (provider.session) {\n        await provider.disconnect();\n        const optionalChains = this.filteredChains.filter(chain => chain.chainId !== targetChainId).map(optionalChain => optionalChain.chainId);\n        this.emit(\"message\", {\n          type: \"connecting\"\n        });\n        await provider.connect({\n          pairingTopic,\n          chains: [targetChainId],\n          optionalChains: optionalChains.length > 0 ? optionalChains : [targetChainId]\n        });\n        await this._setRequestedChainsIds(this.filteredChains.map(_ref => {\n          let {\n            chainId\n          } = _ref;\n          return chainId;\n        }));\n      }\n\n      // If session exists and chains are authorized, enable provider for required chain\n      const accounts = await provider.enable();\n      if (!accounts[0]) {\n        throw new Error(\"No accounts found on provider.\");\n      }\n      const account = ethers__WEBPACK_IMPORTED_MODULE_4__.utils.getAddress(accounts[0]);\n      const id = await this.getChainId();\n      const unsupported = this.isChainUnsupported(id);\n      return {\n        account,\n        chain: {\n          id,\n          unsupported\n        },\n        provider: new ethers__WEBPACK_IMPORTED_MODULE_4__.providers.Web3Provider(provider)\n      };\n    } catch (error) {\n      if (/user rejected/i.test(error?.message)) {\n        throw new _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.U(error);\n      }\n      throw error;\n    }\n  }\n  async disconnect() {\n    const cleanup = () => {\n      if (typeof localStorage === \"undefined\") {\n        return;\n      }\n      for (const key in localStorage) {\n        if (key.startsWith(\"wc@2\")) {\n          localStorage.removeItem(key);\n        }\n      }\n    };\n    cleanup();\n    const provider = await this.getProvider();\n    const disconnectProvider = async () => {\n      try {\n        await provider.disconnect();\n      } catch (error) {\n        if (!/No matching key/i.test(error.message)) {\n          throw error;\n        }\n      } finally {\n        this._removeListeners();\n        await this._setRequestedChainsIds([]);\n        cleanup();\n      }\n    };\n    disconnectProvider();\n  }\n  async getAccount() {\n    const {\n      accounts\n    } = await this.getProvider();\n    if (!accounts[0]) {\n      throw new Error(\"No accounts found on provider.\");\n    }\n    return ethers__WEBPACK_IMPORTED_MODULE_4__.utils.getAddress(accounts[0]);\n  }\n  async getChainId() {\n    const {\n      chainId\n    } = await this.getProvider();\n    return chainId;\n  }\n  async getProvider() {\n    let {\n      chainId\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (!this._provider) {\n      await this._createProvider();\n    }\n    if (chainId) {\n      await this.switchChain(chainId);\n    }\n    if (!this._provider) {\n      throw new Error(\"No provider found.\");\n    }\n    return this._provider;\n  }\n  async getSigner() {\n    let {\n      chainId\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const [provider, account] = await Promise.all([this.getProvider({\n      chainId\n    }), this.getAccount()]);\n    return new ethers__WEBPACK_IMPORTED_MODULE_4__.providers.Web3Provider(provider, chainId).getSigner(account);\n  }\n  async isAuthorized() {\n    try {\n      const [account, provider] = await Promise.all([this.getAccount(), this.getProvider()]);\n      const isChainsStale = await this._isChainsStale();\n\n      // If an account does not exist on the session, then the connector is unauthorized.\n      if (!account) {\n        return false;\n      }\n\n      // If the chains are stale on the session, then the connector is unauthorized.\n      if (isChainsStale && provider.session) {\n        try {\n          await provider.disconnect();\n        } catch {} // eslint-disable-line no-empty\n        return false;\n      }\n      return true;\n    } catch {\n      return false;\n    }\n  }\n  async switchChain(chainId) {\n    const chain = this.chains.find(chain_ => chain_.chainId === chainId);\n    if (!chain) {\n      throw new _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.S(`Chain with ID: ${chainId}, not found on connector.`);\n    }\n    try {\n      const provider = await this.getProvider();\n      const namespaceChains = this._getNamespaceChainsIds();\n      const namespaceMethods = this._getNamespaceMethods();\n      const isChainApproved = namespaceChains.includes(chainId);\n      if (!isChainApproved && namespaceMethods.includes(ADD_ETH_CHAIN_METHOD)) {\n        const firstExplorer = chain.explorers && chain.explorers[0];\n        const blockExplorerUrls = firstExplorer ? {\n          blockExplorerUrls: [firstExplorer.url]\n        } : {};\n        await provider.request({\n          method: ADD_ETH_CHAIN_METHOD,\n          params: [{\n            chainId: ethers__WEBPACK_IMPORTED_MODULE_4__.utils.hexValue(chain.chainId),\n            chainName: chain.name,\n            nativeCurrency: chain.nativeCurrency,\n            rpcUrls: (0,_dist_url_a45219bd_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.g)(chain),\n            // no clientId on purpose\n            ...blockExplorerUrls\n          }]\n        });\n        const requestedChains = await this._getRequestedChainsIds();\n        requestedChains.push(chainId);\n        await this._setRequestedChainsIds(requestedChains);\n      }\n      await provider.request({\n        method: \"wallet_switchEthereumChain\",\n        params: [{\n          chainId: ethers__WEBPACK_IMPORTED_MODULE_4__.utils.hexValue(chainId)\n        }]\n      });\n      return chain;\n    } catch (error) {\n      const message = typeof error === \"string\" ? error : error?.message;\n      if (/user rejected request/i.test(message)) {\n        throw new _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.U(error);\n      }\n      throw new _dist_errors_9edc08c8_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.S(error);\n    }\n  }\n  async _createProvider() {\n    if (!this._initProviderPromise && \"object\" !== \"undefined\") {\n      this._initProviderPromise = this.initProvider();\n    }\n    return this._initProviderPromise;\n  }\n  async initProvider() {\n    const {\n      default: EthereumProvider,\n      OPTIONAL_EVENTS,\n      OPTIONAL_METHODS\n    } = await __webpack_require__.e(/*! import() */ \"node_modules_walletconnect_ethereum-provider_dist_index_es_js\").then(__webpack_require__.bind(__webpack_require__, /*! @walletconnect/ethereum-provider */ \"./node_modules/@walletconnect/ethereum-provider/dist/index.es.js\"));\n    const [defaultChain, ...optionalChains] = this.filteredChains.map(_ref2 => {\n      let {\n        chainId\n      } = _ref2;\n      return chainId;\n    });\n    if (defaultChain) {\n      // EthereumProvider populates & deduplicates required methods and events internally\n      this._provider = await EthereumProvider.init({\n        showQrModal: this.showWalletConnectModal,\n        projectId: this.options.projectId,\n        optionalMethods: OPTIONAL_METHODS,\n        optionalEvents: OPTIONAL_EVENTS,\n        chains: [defaultChain],\n        optionalChains: optionalChains,\n        metadata: {\n          name: this.options.dappMetadata.name,\n          description: this.options.dappMetadata.description || \"\",\n          url: this.options.dappMetadata.url,\n          icons: [this.options.dappMetadata.logoUrl || \"\"]\n        },\n        rpcMap: Object.fromEntries(this.filteredChains.map(chain => [chain.chainId, chain.rpc[0] || \"\" // TODO: handle chain.rpc being empty array\n        ])),\n        qrModalOptions: this.options.qrModalOptions\n      });\n    }\n  }\n\n  /**\n   * Checks if the target chains match the chains that were\n   * initially requested by the connector for the WalletConnect session.\n   * If there is a mismatch, this means that the chains on the connector\n   * are considered stale, and need to be revalidated at a later point (via\n   * connection).\n   *\n   * There may be a scenario where a dapp adds a chain to the\n   * connector later on, however, this chain will not have been approved or rejected\n   * by the wallet. In this case, the chain is considered stale.\n   *\n   * There are exceptions however:\n   * -  If the wallet supports dynamic chain addition via `eth_addEthereumChain`,\n   *    then the chain is not considered stale.\n   * -  If the `isNewChainsStale` flag is falsy on the connector, then the chain is\n   *    not considered stale.\n   *\n   * For the above cases, chain validation occurs dynamically when the user\n   * attempts to switch chain.\n   *\n   * Also check that dapp supports at least 1 chain from previously approved session.\n   */\n  async _isChainsStale() {\n    const namespaceMethods = this._getNamespaceMethods();\n    if (namespaceMethods.includes(ADD_ETH_CHAIN_METHOD)) {\n      return false;\n    }\n    if (!this.options.isNewChainsStale) {\n      return false;\n    }\n    const requestedChains = await this._getRequestedChainsIds();\n    const connectorChains = this.filteredChains.map(_ref3 => {\n      let {\n        chainId\n      } = _ref3;\n      return chainId;\n    });\n    const namespaceChains = this._getNamespaceChainsIds();\n    if (namespaceChains.length && !namespaceChains.some(id => connectorChains.includes(id))) {\n      return false;\n    }\n    return !connectorChains.every(id => requestedChains.includes(id));\n  }\n  async setupListeners() {\n    if (!this._provider) {\n      return;\n    }\n    this._removeListeners();\n    this._provider.on(\"accountsChanged\", this.onAccountsChanged);\n    this._provider.on(\"chainChanged\", this.onChainChanged);\n    this._provider.on(\"disconnect\", this.onDisconnect);\n    this._provider.on(\"session_delete\", this.onDisconnect);\n    this._provider.on(\"display_uri\", this.onDisplayUri);\n    this._provider.on(\"connect\", this.onConnect);\n  }\n  _removeListeners() {\n    if (!this._provider) {\n      return;\n    }\n    this._provider.removeListener(\"accountsChanged\", this.onAccountsChanged);\n    this._provider.removeListener(\"chainChanged\", this.onChainChanged);\n    this._provider.removeListener(\"disconnect\", this.onDisconnect);\n    this._provider.removeListener(\"session_delete\", this.onDisconnect);\n    this._provider.removeListener(\"display_uri\", this.onDisplayUri);\n    this._provider.removeListener(\"connect\", this.onConnect);\n  }\n  async _setRequestedChainsIds(chains) {\n    await this._storage.setItem(REQUESTED_CHAINS_KEY, JSON.stringify(chains));\n  }\n  async _getRequestedChainsIds() {\n    const data = await this._storage.getItem(REQUESTED_CHAINS_KEY);\n    return data ? JSON.parse(data) : [];\n  }\n  _getNamespaceChainsIds() {\n    if (!this._provider) {\n      return [];\n    }\n    const chainIds = this._provider.session?.namespaces[NAMESPACE]?.chains?.map(chain => parseInt(chain.split(\":\")[1] || \"\"));\n    return chainIds ?? [];\n  }\n  _getNamespaceMethods() {\n    if (!this._provider) {\n      return [];\n    }\n    const methods = this._provider.session?.namespaces[NAMESPACE]?.methods;\n    return methods ?? [];\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHRoaXJkd2ViLWRldi93YWxsZXRzL2V2bS9jb25uZWN0b3JzL3dhbGxldC1jb25uZWN0L2Rpc3QvdGhpcmR3ZWItZGV2LXdhbGxldHMtZXZtLWNvbm5lY3RvcnMtd2FsbGV0LWNvbm5lY3QuYnJvd3Nlci5lc20uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDd0I7QUFDN0U7QUFDMEM7QUFDSztBQUNLO0FBQ2hFO0FBQ1A7O0FBRXZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsMkVBQWM7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSSwrRUFBZSxhQUFhLHNFQUFTO0FBQ3pDLElBQUksK0VBQWU7QUFDbkIsSUFBSSwrRUFBZTtBQUNuQixJQUFJLCtFQUFlO0FBQ25CO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLHFCQUFxQix5Q0FBSztBQUMxQixXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJLCtFQUFlO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLElBQUksK0VBQWU7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUksK0VBQWU7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxJQUFJLCtFQUFlO0FBQ25CO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7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d2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQHRoaXJkd2ViLWRldi93YWxsZXRzL2V2bS9jb25uZWN0b3JzL3dhbGxldC1jb25uZWN0L2Rpc3QvdGhpcmR3ZWItZGV2LXdhbGxldHMtZXZtLWNvbm5lY3RvcnMtd2FsbGV0LWNvbm5lY3QuYnJvd3Nlci5lc20uanM/NjIyYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfIGFzIF9kZWZpbmVQcm9wZXJ0eSB9IGZyb20gJy4uLy4uLy4uLy4uL2Rpc3QvZGVmaW5lUHJvcGVydHktMzUwZmM1MDguYnJvd3Nlci5lc20uanMnO1xuaW1wb3J0IHsgVSBhcyBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IsIFMgYXMgU3dpdGNoQ2hhaW5FcnJvciB9IGZyb20gJy4uLy4uLy4uLy4uL2Rpc3QvZXJyb3JzLTllZGMwOGM4LmJyb3dzZXIuZXNtLmpzJztcbmltcG9ydCB7IHV0aWxzLCBwcm92aWRlcnMgfSBmcm9tICdldGhlcnMnO1xuaW1wb3J0IHsgdyBhcyB3YWxsZXRJZHMgfSBmcm9tICcuLi8uLi8uLi8uLi9kaXN0L3dhbGxldElkcy1kZmY2ZGNlZC5icm93c2VyLmVzbS5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldFZhbGlkUHVibGljUlBDVXJsIH0gZnJvbSAnLi4vLi4vLi4vLi4vZGlzdC91cmwtYTQ1MjE5YmQuYnJvd3Nlci5lc20uanMnO1xuaW1wb3J0IHsgVyBhcyBXYWdtaUNvbm5lY3RvciB9IGZyb20gJy4uLy4uLy4uLy4uL2Rpc3QvV2FnbWlDb25uZWN0b3ItMmYxNDAwMmQuYnJvd3Nlci5lc20uanMnO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NoYWlucyc7XG5pbXBvcnQgJ2V2ZW50ZW1pdHRlcjMnO1xuXG5jb25zdCBjaGFpbnNUb1JlcXVlc3QgPSBuZXcgU2V0KFsxLCAxMzcsIDEwLCA0MjE2MSwgNTZdKTtcbmNvbnN0IE5BTUVTUEFDRSA9IFwiZWlwMTU1XCI7XG5jb25zdCBSRVFVRVNURURfQ0hBSU5TX0tFWSA9IFwid2FnbWkucmVxdWVzdGVkQ2hhaW5zXCI7XG5jb25zdCBBRERfRVRIX0NIQUlOX01FVEhPRCA9IFwid2FsbGV0X2FkZEV0aGVyZXVtQ2hhaW5cIjtcbmNvbnN0IExBU1RfVVNFRF9DSEFJTl9JRCA9IFwibGFzdC11c2VkLWNoYWluLWlkXCI7XG5jbGFzcyBXYWxsZXRDb25uZWN0Q29ubmVjdG9yIGV4dGVuZHMgV2FnbWlDb25uZWN0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICBzdXBlcih7XG4gICAgICAuLi5jb25maWcsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGlzTmV3Q2hhaW5zU3RhbGU6IHRydWUsXG4gICAgICAgIC4uLmNvbmZpZy5vcHRpb25zXG4gICAgICB9XG4gICAgfSk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwiaWRcIiwgd2FsbGV0SWRzLndhbGxldENvbm5lY3QpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5hbWVcIiwgXCJXYWxsZXRDb25uZWN0XCIpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInJlYWR5XCIsIHRydWUpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm9uQWNjb3VudHNDaGFuZ2VkXCIsIGFjY291bnRzID0+IHtcbiAgICAgIGlmIChhY2NvdW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhpcy5lbWl0KFwiZGlzY29ubmVjdFwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChhY2NvdW50c1swXSkge1xuICAgICAgICAgIHRoaXMuZW1pdChcImNoYW5nZVwiLCB7XG4gICAgICAgICAgICBhY2NvdW50OiB1dGlscy5nZXRBZGRyZXNzKGFjY291bnRzWzBdKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwib25DaGFpbkNoYW5nZWRcIiwgYXN5bmMgY2hhaW5JZCA9PiB7XG4gICAgICBjb25zdCBpZCA9IE51bWJlcihjaGFpbklkKTtcbiAgICAgIGNvbnN0IHVuc3VwcG9ydGVkID0gdGhpcy5pc0NoYWluVW5zdXBwb3J0ZWQoaWQpO1xuICAgICAgYXdhaXQgdGhpcy5fc3RvcmFnZS5zZXRJdGVtKExBU1RfVVNFRF9DSEFJTl9JRCwgU3RyaW5nKGNoYWluSWQpKTtcbiAgICAgIHRoaXMuZW1pdChcImNoYW5nZVwiLCB7XG4gICAgICAgIGNoYWluOiB7XG4gICAgICAgICAgaWQsXG4gICAgICAgICAgdW5zdXBwb3J0ZWRcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwib25EaXNjb25uZWN0XCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHRoaXMuX3NldFJlcXVlc3RlZENoYWluc0lkcyhbXSk7XG4gICAgICBhd2FpdCB0aGlzLl9zdG9yYWdlLnJlbW92ZUl0ZW0oTEFTVF9VU0VEX0NIQUlOX0lEKTtcbiAgICAgIHRoaXMuZW1pdChcImRpc2Nvbm5lY3RcIik7XG4gICAgfSk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwib25EaXNwbGF5VXJpXCIsIHVyaSA9PiB7XG4gICAgICB0aGlzLmVtaXQoXCJtZXNzYWdlXCIsIHtcbiAgICAgICAgdHlwZTogXCJkaXNwbGF5X3VyaVwiLFxuICAgICAgICBkYXRhOiB1cmlcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm9uQ29ubmVjdFwiLCAoKSA9PiB7XG4gICAgICB0aGlzLmVtaXQoXCJjb25uZWN0XCIsIHtcbiAgICAgICAgcHJvdmlkZXI6IHRoaXMuX3Byb3ZpZGVyXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICB0aGlzLl9zdG9yYWdlID0gY29uZmlnLm9wdGlvbnMuc3RvcmFnZTtcbiAgICB0aGlzLl9jcmVhdGVQcm92aWRlcigpO1xuICAgIHRoaXMuZmlsdGVyZWRDaGFpbnMgPSB0aGlzLmNoYWlucy5sZW5ndGggPiA1MCA/IHRoaXMuY2hhaW5zLmZpbHRlcihjID0+IHtcbiAgICAgIHJldHVybiBjaGFpbnNUb1JlcXVlc3QuaGFzKGMuY2hhaW5JZCk7XG4gICAgfSkgOiB0aGlzLmNoYWlucztcbiAgICB0aGlzLnNob3dXYWxsZXRDb25uZWN0TW9kYWwgPSB0aGlzLm9wdGlvbnMucXJjb2RlICE9PSBmYWxzZTtcbiAgfVxuICBhc3luYyBjb25uZWN0KCkge1xuICAgIGxldCB7XG4gICAgICBjaGFpbklkOiBjaGFpbklkUCxcbiAgICAgIHBhaXJpbmdUb3BpY1xuICAgIH0gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuICAgIHRyeSB7XG4gICAgICBsZXQgdGFyZ2V0Q2hhaW5JZCA9IGNoYWluSWRQO1xuICAgICAgaWYgKCF0YXJnZXRDaGFpbklkKSB7XG4gICAgICAgIGNvbnN0IGxhc3RVc2VkQ2hhaW5JZFN0ciA9IGF3YWl0IHRoaXMuX3N0b3JhZ2UuZ2V0SXRlbShMQVNUX1VTRURfQ0hBSU5fSUQpO1xuICAgICAgICBjb25zdCBsYXN0VXNlZENoYWluSWQgPSBsYXN0VXNlZENoYWluSWRTdHIgPyBwYXJzZUludChsYXN0VXNlZENoYWluSWRTdHIpIDogdW5kZWZpbmVkO1xuICAgICAgICBpZiAobGFzdFVzZWRDaGFpbklkICYmICF0aGlzLmlzQ2hhaW5VbnN1cHBvcnRlZChsYXN0VXNlZENoYWluSWQpKSB7XG4gICAgICAgICAgdGFyZ2V0Q2hhaW5JZCA9IGxhc3RVc2VkQ2hhaW5JZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0YXJnZXRDaGFpbklkID0gdGhpcy5maWx0ZXJlZENoYWluc1swXT8uY2hhaW5JZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCF0YXJnZXRDaGFpbklkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGNoYWlucyBmb3VuZCBvbiBjb25uZWN0b3IuXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldFByb3ZpZGVyKCk7XG4gICAgICB0aGlzLnNldHVwTGlzdGVuZXJzKCk7XG4gICAgICBpZiAocHJvdmlkZXIuc2Vzc2lvbikge1xuICAgICAgICBhd2FpdCBwcm92aWRlci5kaXNjb25uZWN0KCk7XG4gICAgICAgIGNvbnN0IG9wdGlvbmFsQ2hhaW5zID0gdGhpcy5maWx0ZXJlZENoYWlucy5maWx0ZXIoY2hhaW4gPT4gY2hhaW4uY2hhaW5JZCAhPT0gdGFyZ2V0Q2hhaW5JZCkubWFwKG9wdGlvbmFsQ2hhaW4gPT4gb3B0aW9uYWxDaGFpbi5jaGFpbklkKTtcbiAgICAgICAgdGhpcy5lbWl0KFwibWVzc2FnZVwiLCB7XG4gICAgICAgICAgdHlwZTogXCJjb25uZWN0aW5nXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHByb3ZpZGVyLmNvbm5lY3Qoe1xuICAgICAgICAgIHBhaXJpbmdUb3BpYyxcbiAgICAgICAgICBjaGFpbnM6IFt0YXJnZXRDaGFpbklkXSxcbiAgICAgICAgICBvcHRpb25hbENoYWluczogb3B0aW9uYWxDaGFpbnMubGVuZ3RoID4gMCA/IG9wdGlvbmFsQ2hhaW5zIDogW3RhcmdldENoYWluSWRdXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0aGlzLl9zZXRSZXF1ZXN0ZWRDaGFpbnNJZHModGhpcy5maWx0ZXJlZENoYWlucy5tYXAoX3JlZiA9PiB7XG4gICAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIGNoYWluSWRcbiAgICAgICAgICB9ID0gX3JlZjtcbiAgICAgICAgICByZXR1cm4gY2hhaW5JZDtcbiAgICAgICAgfSkpO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiBzZXNzaW9uIGV4aXN0cyBhbmQgY2hhaW5zIGFyZSBhdXRob3JpemVkLCBlbmFibGUgcHJvdmlkZXIgZm9yIHJlcXVpcmVkIGNoYWluXG4gICAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IHByb3ZpZGVyLmVuYWJsZSgpO1xuICAgICAgaWYgKCFhY2NvdW50c1swXSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhY2NvdW50cyBmb3VuZCBvbiBwcm92aWRlci5cIik7XG4gICAgICB9XG4gICAgICBjb25zdCBhY2NvdW50ID0gdXRpbHMuZ2V0QWRkcmVzcyhhY2NvdW50c1swXSk7XG4gICAgICBjb25zdCBpZCA9IGF3YWl0IHRoaXMuZ2V0Q2hhaW5JZCgpO1xuICAgICAgY29uc3QgdW5zdXBwb3J0ZWQgPSB0aGlzLmlzQ2hhaW5VbnN1cHBvcnRlZChpZCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhY2NvdW50LFxuICAgICAgICBjaGFpbjoge1xuICAgICAgICAgIGlkLFxuICAgICAgICAgIHVuc3VwcG9ydGVkXG4gICAgICAgIH0sXG4gICAgICAgIHByb3ZpZGVyOiBuZXcgcHJvdmlkZXJzLldlYjNQcm92aWRlcihwcm92aWRlcilcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmICgvdXNlciByZWplY3RlZC9pLnRlc3QoZXJyb3I/Lm1lc3NhZ2UpKSB7XG4gICAgICAgIHRocm93IG5ldyBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IoZXJyb3IpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG4gIGFzeW5jIGRpc2Nvbm5lY3QoKSB7XG4gICAgY29uc3QgY2xlYW51cCA9ICgpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgbG9jYWxTdG9yYWdlID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGZvciAoY29uc3Qga2V5IGluIGxvY2FsU3RvcmFnZSkge1xuICAgICAgICBpZiAoa2V5LnN0YXJ0c1dpdGgoXCJ3Y0AyXCIpKSB7XG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgY2xlYW51cCgpO1xuICAgIGNvbnN0IHByb3ZpZGVyID0gYXdhaXQgdGhpcy5nZXRQcm92aWRlcigpO1xuICAgIGNvbnN0IGRpc2Nvbm5lY3RQcm92aWRlciA9IGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHByb3ZpZGVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGlmICghL05vIG1hdGNoaW5nIGtleS9pLnRlc3QoZXJyb3IubWVzc2FnZSkpIHtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgdGhpcy5fcmVtb3ZlTGlzdGVuZXJzKCk7XG4gICAgICAgIGF3YWl0IHRoaXMuX3NldFJlcXVlc3RlZENoYWluc0lkcyhbXSk7XG4gICAgICAgIGNsZWFudXAoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGRpc2Nvbm5lY3RQcm92aWRlcigpO1xuICB9XG4gIGFzeW5jIGdldEFjY291bnQoKSB7XG4gICAgY29uc3Qge1xuICAgICAgYWNjb3VudHNcbiAgICB9ID0gYXdhaXQgdGhpcy5nZXRQcm92aWRlcigpO1xuICAgIGlmICghYWNjb3VudHNbMF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGFjY291bnRzIGZvdW5kIG9uIHByb3ZpZGVyLlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHV0aWxzLmdldEFkZHJlc3MoYWNjb3VudHNbMF0pO1xuICB9XG4gIGFzeW5jIGdldENoYWluSWQoKSB7XG4gICAgY29uc3Qge1xuICAgICAgY2hhaW5JZFxuICAgIH0gPSBhd2FpdCB0aGlzLmdldFByb3ZpZGVyKCk7XG4gICAgcmV0dXJuIGNoYWluSWQ7XG4gIH1cbiAgYXN5bmMgZ2V0UHJvdmlkZXIoKSB7XG4gICAgbGV0IHtcbiAgICAgIGNoYWluSWRcbiAgICB9ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgICBpZiAoIXRoaXMuX3Byb3ZpZGVyKSB7XG4gICAgICBhd2FpdCB0aGlzLl9jcmVhdGVQcm92aWRlcigpO1xuICAgIH1cbiAgICBpZiAoY2hhaW5JZCkge1xuICAgICAgYXdhaXQgdGhpcy5zd2l0Y2hDaGFpbihjaGFpbklkKTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLl9wcm92aWRlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gcHJvdmlkZXIgZm91bmQuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fcHJvdmlkZXI7XG4gIH1cbiAgYXN5bmMgZ2V0U2lnbmVyKCkge1xuICAgIGxldCB7XG4gICAgICBjaGFpbklkXG4gICAgfSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgY29uc3QgW3Byb3ZpZGVyLCBhY2NvdW50XSA9IGF3YWl0IFByb21pc2UuYWxsKFt0aGlzLmdldFByb3ZpZGVyKHtcbiAgICAgIGNoYWluSWRcbiAgICB9KSwgdGhpcy5nZXRBY2NvdW50KCldKTtcbiAgICByZXR1cm4gbmV3IHByb3ZpZGVycy5XZWIzUHJvdmlkZXIocHJvdmlkZXIsIGNoYWluSWQpLmdldFNpZ25lcihhY2NvdW50KTtcbiAgfVxuICBhc3luYyBpc0F1dGhvcml6ZWQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IFthY2NvdW50LCBwcm92aWRlcl0gPSBhd2FpdCBQcm9taXNlLmFsbChbdGhpcy5nZXRBY2NvdW50KCksIHRoaXMuZ2V0UHJvdmlkZXIoKV0pO1xuICAgICAgY29uc3QgaXNDaGFpbnNTdGFsZSA9IGF3YWl0IHRoaXMuX2lzQ2hhaW5zU3RhbGUoKTtcblxuICAgICAgLy8gSWYgYW4gYWNjb3VudCBkb2VzIG5vdCBleGlzdCBvbiB0aGUgc2Vzc2lvbiwgdGhlbiB0aGUgY29ubmVjdG9yIGlzIHVuYXV0aG9yaXplZC5cbiAgICAgIGlmICghYWNjb3VudCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIHRoZSBjaGFpbnMgYXJlIHN0YWxlIG9uIHRoZSBzZXNzaW9uLCB0aGVuIHRoZSBjb25uZWN0b3IgaXMgdW5hdXRob3JpemVkLlxuICAgICAgaWYgKGlzQ2hhaW5zU3RhbGUgJiYgcHJvdmlkZXIuc2Vzc2lvbikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHByb3ZpZGVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgfSBjYXRjaCB7fSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWVtcHR5XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBhc3luYyBzd2l0Y2hDaGFpbihjaGFpbklkKSB7XG4gICAgY29uc3QgY2hhaW4gPSB0aGlzLmNoYWlucy5maW5kKGNoYWluXyA9PiBjaGFpbl8uY2hhaW5JZCA9PT0gY2hhaW5JZCk7XG4gICAgaWYgKCFjaGFpbikge1xuICAgICAgdGhyb3cgbmV3IFN3aXRjaENoYWluRXJyb3IoYENoYWluIHdpdGggSUQ6ICR7Y2hhaW5JZH0sIG5vdCBmb3VuZCBvbiBjb25uZWN0b3IuYCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IGF3YWl0IHRoaXMuZ2V0UHJvdmlkZXIoKTtcbiAgICAgIGNvbnN0IG5hbWVzcGFjZUNoYWlucyA9IHRoaXMuX2dldE5hbWVzcGFjZUNoYWluc0lkcygpO1xuICAgICAgY29uc3QgbmFtZXNwYWNlTWV0aG9kcyA9IHRoaXMuX2dldE5hbWVzcGFjZU1ldGhvZHMoKTtcbiAgICAgIGNvbnN0IGlzQ2hhaW5BcHByb3ZlZCA9IG5hbWVzcGFjZUNoYWlucy5pbmNsdWRlcyhjaGFpbklkKTtcbiAgICAgIGlmICghaXNDaGFpbkFwcHJvdmVkICYmIG5hbWVzcGFjZU1ldGhvZHMuaW5jbHVkZXMoQUREX0VUSF9DSEFJTl9NRVRIT0QpKSB7XG4gICAgICAgIGNvbnN0IGZpcnN0RXhwbG9yZXIgPSBjaGFpbi5leHBsb3JlcnMgJiYgY2hhaW4uZXhwbG9yZXJzWzBdO1xuICAgICAgICBjb25zdCBibG9ja0V4cGxvcmVyVXJscyA9IGZpcnN0RXhwbG9yZXIgPyB7XG4gICAgICAgICAgYmxvY2tFeHBsb3JlclVybHM6IFtmaXJzdEV4cGxvcmVyLnVybF1cbiAgICAgICAgfSA6IHt9O1xuICAgICAgICBhd2FpdCBwcm92aWRlci5yZXF1ZXN0KHtcbiAgICAgICAgICBtZXRob2Q6IEFERF9FVEhfQ0hBSU5fTUVUSE9ELFxuICAgICAgICAgIHBhcmFtczogW3tcbiAgICAgICAgICAgIGNoYWluSWQ6IHV0aWxzLmhleFZhbHVlKGNoYWluLmNoYWluSWQpLFxuICAgICAgICAgICAgY2hhaW5OYW1lOiBjaGFpbi5uYW1lLFxuICAgICAgICAgICAgbmF0aXZlQ3VycmVuY3k6IGNoYWluLm5hdGl2ZUN1cnJlbmN5LFxuICAgICAgICAgICAgcnBjVXJsczogZ2V0VmFsaWRQdWJsaWNSUENVcmwoY2hhaW4pLFxuICAgICAgICAgICAgLy8gbm8gY2xpZW50SWQgb24gcHVycG9zZVxuICAgICAgICAgICAgLi4uYmxvY2tFeHBsb3JlclVybHNcbiAgICAgICAgICB9XVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcmVxdWVzdGVkQ2hhaW5zID0gYXdhaXQgdGhpcy5fZ2V0UmVxdWVzdGVkQ2hhaW5zSWRzKCk7XG4gICAgICAgIHJlcXVlc3RlZENoYWlucy5wdXNoKGNoYWluSWQpO1xuICAgICAgICBhd2FpdCB0aGlzLl9zZXRSZXF1ZXN0ZWRDaGFpbnNJZHMocmVxdWVzdGVkQ2hhaW5zKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHByb3ZpZGVyLnJlcXVlc3Qoe1xuICAgICAgICBtZXRob2Q6IFwid2FsbGV0X3N3aXRjaEV0aGVyZXVtQ2hhaW5cIixcbiAgICAgICAgcGFyYW1zOiBbe1xuICAgICAgICAgIGNoYWluSWQ6IHV0aWxzLmhleFZhbHVlKGNoYWluSWQpXG4gICAgICAgIH1dXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjaGFpbjtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHR5cGVvZiBlcnJvciA9PT0gXCJzdHJpbmdcIiA/IGVycm9yIDogZXJyb3I/Lm1lc3NhZ2U7XG4gICAgICBpZiAoL3VzZXIgcmVqZWN0ZWQgcmVxdWVzdC9pLnRlc3QobWVzc2FnZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFVzZXJSZWplY3RlZFJlcXVlc3RFcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgU3dpdGNoQ2hhaW5FcnJvcihlcnJvcik7XG4gICAgfVxuICB9XG4gIGFzeW5jIF9jcmVhdGVQcm92aWRlcigpIHtcbiAgICBpZiAoIXRoaXMuX2luaXRQcm92aWRlclByb21pc2UgJiYgXCJvYmplY3RcIiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgdGhpcy5faW5pdFByb3ZpZGVyUHJvbWlzZSA9IHRoaXMuaW5pdFByb3ZpZGVyKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9pbml0UHJvdmlkZXJQcm9taXNlO1xuICB9XG4gIGFzeW5jIGluaXRQcm92aWRlcigpIHtcbiAgICBjb25zdCB7XG4gICAgICBkZWZhdWx0OiBFdGhlcmV1bVByb3ZpZGVyLFxuICAgICAgT1BUSU9OQUxfRVZFTlRTLFxuICAgICAgT1BUSU9OQUxfTUVUSE9EU1xuICAgIH0gPSBhd2FpdCBpbXBvcnQoJ0B3YWxsZXRjb25uZWN0L2V0aGVyZXVtLXByb3ZpZGVyJyk7XG4gICAgY29uc3QgW2RlZmF1bHRDaGFpbiwgLi4ub3B0aW9uYWxDaGFpbnNdID0gdGhpcy5maWx0ZXJlZENoYWlucy5tYXAoX3JlZjIgPT4ge1xuICAgICAgbGV0IHtcbiAgICAgICAgY2hhaW5JZFxuICAgICAgfSA9IF9yZWYyO1xuICAgICAgcmV0dXJuIGNoYWluSWQ7XG4gICAgfSk7XG4gICAgaWYgKGRlZmF1bHRDaGFpbikge1xuICAgICAgLy8gRXRoZXJldW1Qcm92aWRlciBwb3B1bGF0ZXMgJiBkZWR1cGxpY2F0ZXMgcmVxdWlyZWQgbWV0aG9kcyBhbmQgZXZlbnRzIGludGVybmFsbHlcbiAgICAgIHRoaXMuX3Byb3ZpZGVyID0gYXdhaXQgRXRoZXJldW1Qcm92aWRlci5pbml0KHtcbiAgICAgICAgc2hvd1FyTW9kYWw6IHRoaXMuc2hvd1dhbGxldENvbm5lY3RNb2RhbCxcbiAgICAgICAgcHJvamVjdElkOiB0aGlzLm9wdGlvbnMucHJvamVjdElkLFxuICAgICAgICBvcHRpb25hbE1ldGhvZHM6IE9QVElPTkFMX01FVEhPRFMsXG4gICAgICAgIG9wdGlvbmFsRXZlbnRzOiBPUFRJT05BTF9FVkVOVFMsXG4gICAgICAgIGNoYWluczogW2RlZmF1bHRDaGFpbl0sXG4gICAgICAgIG9wdGlvbmFsQ2hhaW5zOiBvcHRpb25hbENoYWlucyxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBuYW1lOiB0aGlzLm9wdGlvbnMuZGFwcE1ldGFkYXRhLm5hbWUsXG4gICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMub3B0aW9ucy5kYXBwTWV0YWRhdGEuZGVzY3JpcHRpb24gfHwgXCJcIixcbiAgICAgICAgICB1cmw6IHRoaXMub3B0aW9ucy5kYXBwTWV0YWRhdGEudXJsLFxuICAgICAgICAgIGljb25zOiBbdGhpcy5vcHRpb25zLmRhcHBNZXRhZGF0YS5sb2dvVXJsIHx8IFwiXCJdXG4gICAgICAgIH0sXG4gICAgICAgIHJwY01hcDogT2JqZWN0LmZyb21FbnRyaWVzKHRoaXMuZmlsdGVyZWRDaGFpbnMubWFwKGNoYWluID0+IFtjaGFpbi5jaGFpbklkLCBjaGFpbi5ycGNbMF0gfHwgXCJcIiAvLyBUT0RPOiBoYW5kbGUgY2hhaW4ucnBjIGJlaW5nIGVtcHR5IGFycmF5XG4gICAgICAgIF0pKSxcbiAgICAgICAgcXJNb2RhbE9wdGlvbnM6IHRoaXMub3B0aW9ucy5xck1vZGFsT3B0aW9uc1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiB0aGUgdGFyZ2V0IGNoYWlucyBtYXRjaCB0aGUgY2hhaW5zIHRoYXQgd2VyZVxuICAgKiBpbml0aWFsbHkgcmVxdWVzdGVkIGJ5IHRoZSBjb25uZWN0b3IgZm9yIHRoZSBXYWxsZXRDb25uZWN0IHNlc3Npb24uXG4gICAqIElmIHRoZXJlIGlzIGEgbWlzbWF0Y2gsIHRoaXMgbWVhbnMgdGhhdCB0aGUgY2hhaW5zIG9uIHRoZSBjb25uZWN0b3JcbiAgICogYXJlIGNvbnNpZGVyZWQgc3RhbGUsIGFuZCBuZWVkIHRvIGJlIHJldmFsaWRhdGVkIGF0IGEgbGF0ZXIgcG9pbnQgKHZpYVxuICAgKiBjb25uZWN0aW9uKS5cbiAgICpcbiAgICogVGhlcmUgbWF5IGJlIGEgc2NlbmFyaW8gd2hlcmUgYSBkYXBwIGFkZHMgYSBjaGFpbiB0byB0aGVcbiAgICogY29ubmVjdG9yIGxhdGVyIG9uLCBob3dldmVyLCB0aGlzIGNoYWluIHdpbGwgbm90IGhhdmUgYmVlbiBhcHByb3ZlZCBvciByZWplY3RlZFxuICAgKiBieSB0aGUgd2FsbGV0LiBJbiB0aGlzIGNhc2UsIHRoZSBjaGFpbiBpcyBjb25zaWRlcmVkIHN0YWxlLlxuICAgKlxuICAgKiBUaGVyZSBhcmUgZXhjZXB0aW9ucyBob3dldmVyOlxuICAgKiAtICBJZiB0aGUgd2FsbGV0IHN1cHBvcnRzIGR5bmFtaWMgY2hhaW4gYWRkaXRpb24gdmlhIGBldGhfYWRkRXRoZXJldW1DaGFpbmAsXG4gICAqICAgIHRoZW4gdGhlIGNoYWluIGlzIG5vdCBjb25zaWRlcmVkIHN0YWxlLlxuICAgKiAtICBJZiB0aGUgYGlzTmV3Q2hhaW5zU3RhbGVgIGZsYWcgaXMgZmFsc3kgb24gdGhlIGNvbm5lY3RvciwgdGhlbiB0aGUgY2hhaW4gaXNcbiAgICogICAgbm90IGNvbnNpZGVyZWQgc3RhbGUuXG4gICAqXG4gICAqIEZvciB0aGUgYWJvdmUgY2FzZXMsIGNoYWluIHZhbGlkYXRpb24gb2NjdXJzIGR5bmFtaWNhbGx5IHdoZW4gdGhlIHVzZXJcbiAgICogYXR0ZW1wdHMgdG8gc3dpdGNoIGNoYWluLlxuICAgKlxuICAgKiBBbHNvIGNoZWNrIHRoYXQgZGFwcCBzdXBwb3J0cyBhdCBsZWFzdCAxIGNoYWluIGZyb20gcHJldmlvdXNseSBhcHByb3ZlZCBzZXNzaW9uLlxuICAgKi9cbiAgYXN5bmMgX2lzQ2hhaW5zU3RhbGUoKSB7XG4gICAgY29uc3QgbmFtZXNwYWNlTWV0aG9kcyA9IHRoaXMuX2dldE5hbWVzcGFjZU1ldGhvZHMoKTtcbiAgICBpZiAobmFtZXNwYWNlTWV0aG9kcy5pbmNsdWRlcyhBRERfRVRIX0NIQUlOX01FVEhPRCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuaXNOZXdDaGFpbnNTdGFsZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCByZXF1ZXN0ZWRDaGFpbnMgPSBhd2FpdCB0aGlzLl9nZXRSZXF1ZXN0ZWRDaGFpbnNJZHMoKTtcbiAgICBjb25zdCBjb25uZWN0b3JDaGFpbnMgPSB0aGlzLmZpbHRlcmVkQ2hhaW5zLm1hcChfcmVmMyA9PiB7XG4gICAgICBsZXQge1xuICAgICAgICBjaGFpbklkXG4gICAgICB9ID0gX3JlZjM7XG4gICAgICByZXR1cm4gY2hhaW5JZDtcbiAgICB9KTtcbiAgICBjb25zdCBuYW1lc3BhY2VDaGFpbnMgPSB0aGlzLl9nZXROYW1lc3BhY2VDaGFpbnNJZHMoKTtcbiAgICBpZiAobmFtZXNwYWNlQ2hhaW5zLmxlbmd0aCAmJiAhbmFtZXNwYWNlQ2hhaW5zLnNvbWUoaWQgPT4gY29ubmVjdG9yQ2hhaW5zLmluY2x1ZGVzKGlkKSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuICFjb25uZWN0b3JDaGFpbnMuZXZlcnkoaWQgPT4gcmVxdWVzdGVkQ2hhaW5zLmluY2x1ZGVzKGlkKSk7XG4gIH1cbiAgYXN5bmMgc2V0dXBMaXN0ZW5lcnMoKSB7XG4gICAgaWYgKCF0aGlzLl9wcm92aWRlcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9yZW1vdmVMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wcm92aWRlci5vbihcImFjY291bnRzQ2hhbmdlZFwiLCB0aGlzLm9uQWNjb3VudHNDaGFuZ2VkKTtcbiAgICB0aGlzLl9wcm92aWRlci5vbihcImNoYWluQ2hhbmdlZFwiLCB0aGlzLm9uQ2hhaW5DaGFuZ2VkKTtcbiAgICB0aGlzLl9wcm92aWRlci5vbihcImRpc2Nvbm5lY3RcIiwgdGhpcy5vbkRpc2Nvbm5lY3QpO1xuICAgIHRoaXMuX3Byb3ZpZGVyLm9uKFwic2Vzc2lvbl9kZWxldGVcIiwgdGhpcy5vbkRpc2Nvbm5lY3QpO1xuICAgIHRoaXMuX3Byb3ZpZGVyLm9uKFwiZGlzcGxheV91cmlcIiwgdGhpcy5vbkRpc3BsYXlVcmkpO1xuICAgIHRoaXMuX3Byb3ZpZGVyLm9uKFwiY29ubmVjdFwiLCB0aGlzLm9uQ29ubmVjdCk7XG4gIH1cbiAgX3JlbW92ZUxpc3RlbmVycygpIHtcbiAgICBpZiAoIXRoaXMuX3Byb3ZpZGVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3Byb3ZpZGVyLnJlbW92ZUxpc3RlbmVyKFwiYWNjb3VudHNDaGFuZ2VkXCIsIHRoaXMub25BY2NvdW50c0NoYW5nZWQpO1xuICAgIHRoaXMuX3Byb3ZpZGVyLnJlbW92ZUxpc3RlbmVyKFwiY2hhaW5DaGFuZ2VkXCIsIHRoaXMub25DaGFpbkNoYW5nZWQpO1xuICAgIHRoaXMuX3Byb3ZpZGVyLnJlbW92ZUxpc3RlbmVyKFwiZGlzY29ubmVjdFwiLCB0aGlzLm9uRGlzY29ubmVjdCk7XG4gICAgdGhpcy5fcHJvdmlkZXIucmVtb3ZlTGlzdGVuZXIoXCJzZXNzaW9uX2RlbGV0ZVwiLCB0aGlzLm9uRGlzY29ubmVjdCk7XG4gICAgdGhpcy5fcHJvdmlkZXIucmVtb3ZlTGlzdGVuZXIoXCJkaXNwbGF5X3VyaVwiLCB0aGlzLm9uRGlzcGxheVVyaSk7XG4gICAgdGhpcy5fcHJvdmlkZXIucmVtb3ZlTGlzdGVuZXIoXCJjb25uZWN0XCIsIHRoaXMub25Db25uZWN0KTtcbiAgfVxuICBhc3luYyBfc2V0UmVxdWVzdGVkQ2hhaW5zSWRzKGNoYWlucykge1xuICAgIGF3YWl0IHRoaXMuX3N0b3JhZ2Uuc2V0SXRlbShSRVFVRVNURURfQ0hBSU5TX0tFWSwgSlNPTi5zdHJpbmdpZnkoY2hhaW5zKSk7XG4gIH1cbiAgYXN5bmMgX2dldFJlcXVlc3RlZENoYWluc0lkcygpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5fc3RvcmFnZS5nZXRJdGVtKFJFUVVFU1RFRF9DSEFJTlNfS0VZKTtcbiAgICByZXR1cm4gZGF0YSA/IEpTT04ucGFyc2UoZGF0YSkgOiBbXTtcbiAgfVxuICBfZ2V0TmFtZXNwYWNlQ2hhaW5zSWRzKCkge1xuICAgIGlmICghdGhpcy5fcHJvdmlkZXIpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgY29uc3QgY2hhaW5JZHMgPSB0aGlzLl9wcm92aWRlci5zZXNzaW9uPy5uYW1lc3BhY2VzW05BTUVTUEFDRV0/LmNoYWlucz8ubWFwKGNoYWluID0+IHBhcnNlSW50KGNoYWluLnNwbGl0KFwiOlwiKVsxXSB8fCBcIlwiKSk7XG4gICAgcmV0dXJuIGNoYWluSWRzID8/IFtdO1xuICB9XG4gIF9nZXROYW1lc3BhY2VNZXRob2RzKCkge1xuICAgIGlmICghdGhpcy5fcHJvdmlkZXIpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgY29uc3QgbWV0aG9kcyA9IHRoaXMuX3Byb3ZpZGVyLnNlc3Npb24/Lm5hbWVzcGFjZXNbTkFNRVNQQUNFXT8ubWV0aG9kcztcbiAgICByZXR1cm4gbWV0aG9kcyA/PyBbXTtcbiAgfVxufVxuXG5leHBvcnQgeyBXYWxsZXRDb25uZWN0Q29ubmVjdG9yIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@thirdweb-dev/wallets/evm/connectors/wallet-connect/dist/thirdweb-dev-wallets-evm-connectors-wallet-connect.browser.esm.js\n"));

/***/ })

}]);